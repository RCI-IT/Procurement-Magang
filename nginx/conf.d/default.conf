# server {
#     listen 80;
#     server_name procurement.rci;

#     client_max_body_size 20M;

#     # ðŸ”µ Main Frontend (Next.js)
#     location / {
#         proxy_pass http://procurementfrontend:3000;
#         proxy_http_version 1.1;
#         proxy_set_header Upgrade $http_upgrade;
#         proxy_set_header Connection 'upgrade';
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_cache_bypass $http_upgrade;
#     }

#     # ðŸŸ¡ Main Backend (Express)
#     location /api/ {
#         rewrite ^/api/?(.*)$ /$1 break;
#         proxy_pass http://procurementbackend:5000;
#         proxy_http_version 1.1;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     }

#     # ðŸ”µ HR Frontend
#     location /hr/ {
#         rewrite ^/hr/(.*)$ /$1 break;
#         proxy_pass http://employeefrontend:3000;
#         proxy_http_version 1.1;
#         proxy_set_header Upgrade $http_upgrade;
#         proxy_set_header Connection 'upgrade';
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_cache_bypass $http_upgrade;
#     }

#     # HR Static files (Next.js)
#     location /hr/_next/ {
#         proxy_pass http://employeefrontend:3000/hr/_next/;
#         proxy_http_version 1.1;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     }


#     # ðŸŸ¡ HR Backend
#     location /apiHR/ {
#         rewrite ^/apiHR/?(.*)$ /$1 break;
#         proxy_pass http://employeebackend:4000;
#         proxy_http_version 1.1;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     }
# }


server {
  listen 80;
  server_name procurement.rci;

  # FRONTEND PROCUREMENT (akses: http://procurement.rci/procurement/)
  location /procurement/ {
    proxy_pass http://procurementfrontend:3000/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
  }

  # API PROCUREMENT
  location /api/ {
    rewrite ^/api/(.*)$ /$1 break;
    proxy_pass http://backend:5000/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
  }

  # FRONTEND EMPLOYEE (akses: http://procurement.rci/employee/)
  location /employee/ {
    rewrite ^/employee/(.*)$ /$1 break;
    proxy_pass http://employeefrontend:3000/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
  }

  # API HR
  location /apiHR/ {
    # rewrite ^/emplapi/(.*)$ /$1 break;
    proxy_pass http://employeebackend:4000/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
  }
}
